# 说明书

目录

- [说明书](#说明书)
  - [专题](#专题)
  - [第三方文档](#第三方文档)
  - [使用方案选单](#使用方案选单)
  - [输入法设定](#输入法设定)
  - [打字入门](#打字入门)
    - [选字与换页](#选字与换页)
    - [令输入码直接上屏](#令输入码直接上屏)
    - [使用编辑键](#使用编辑键)
    - [删除误上屏的错词](#删除误上屏的错词)
    - [Emacs 风格的编辑键](#emacs-风格的编辑键)
    - [输入标点符号](#输入标点符号)
    - [中西文切换](#中西文切换)
    - [繁简字切换](#繁简字切换)
  - [部分输入方案的用法](#部分输入方案的用法)
    - [朙月拼音](#朙月拼音)
    - [语句流](#语句流)
    - [双拼](#双拼)
    - [宫保拼音](#宫保拼音)
    - [地球拼音](#地球拼音)
    - [注音](#注音)
    - [仓颉](#仓颉)
    - [速成](#速成)
    - [五笔](#五笔)
    - [粤拼](#粤拼)
    - [吴语](#吴语)
  - [用户词典管理](#用户词典管理)
    - [命令行工具](#命令行工具)
    - [备份及合并词典快照](#备份及合并词典快照)
    - [导出及导入文本码表](#导出及导入文本码表)
    - [导入其他来源的码表](#导入其他来源的码表)
    - [添加自定义短语](#添加自定义短语)
    - [同步用户资料](#同步用户资料)
      - [设定同步位置](#设定同步位置)


## 专题

  * [[认识 La Rime|Introduction]]
  * [[下载与安装|Downloads]]
  * [[定制指南|CustomizationGuide]]（初阶）
  * [[输入方案设计书|RimeWithSchemata]]（中阶）
  * [[程序开发|RimeWithTheCode]]（高阶）

## 第三方文档

  * [鼠须管试玩心得](http://bbs.weiphone.com/read-htm-tid-5108521.html)／lionhoho
  * [致第一次安装 RIME 的你](https://github.com/halfmoonvic/Rime)／半月湾C
  * [「鼠须管」配置方案分享](https://www.v2ex.com/t/303479)、[
「鼠须管」的调教笔记](https://scomper.me/gtd/-shu-xu-guan-de-diao-jiao-bi-ji)／scomper
  * [鼠须管输入法 傻瓜版配置 - 基于 rime_pro 增强包](https://segmentfault.com/a/1190000005754706)／changsj

## 使用方案选单

下载、安装完成后，试试：

切换到 Rime 输入法，按 `F4` 键或组合键 `` Ctrl+` `` 唤出输入方案选单（`` ` `` 键常见于 `1` 的左方）。这里有 Rime 输入法最常用的选项。

您可立即从方案选单切换到已经启用的输入方案。

另见：从 [Rime 输入方案仓库](https://github.com/rime/plum) 获取输入方案

如果需要启用其他已安装的方案，或自定义方案，请——

## 输入法设定

——参阅[[《定制指南》|CustomizationGuide]]，从中了解如何自定义方案选单、每页候选个数等全局选项；修改界面外观；以及调整输入方案的工作方式如指定选字、换页的按键、标点符号映射等。

目前仅【小狼毫】配有一组简单的设定面板，包含输入方案选单设定、界面风格设定、用户词典管理。其他发行版可通过修改配置文件后重新部署的方式来定制。

## 打字入门

以下操作多数是可定制的，此说明书以默认配置为准。

### 选字与换页

使用 ↑↓键 定位高亮的候选字，以空格键确认。

在【语句流】风格的输入方案里，以空格键确认后，字词并不立即上屏，而是在输入了句末的标点（，。？！等）或按下回车键（`Return`）时整个句子上屏。

通常，按数字键可选择序号为该数字的候选；但某些输入方案会以其他按键代替数字键，如【注音】以大写字母选字。

除了可用标准的 `Page Up`、`Page Down` 换页之外，大多数输入方案里还设置了以下几组等效的换页键：
  * `Shift+Tab`、`Tab`
  * 符号键 `- =`
  * 符号键 `, .`

### 令输入码直接上屏

输入编码后，如果不需要候选字而是希望输入码对应的键盘字符直接上屏，可使用回车键（`Return`）。

注意：【语句流】输入方案不适用。在【语句流】模式下，先按左Shift键切换为西文编码，再按回车键确认。

若要输出经过变换的输入码，如带声调的地球拼音、注音符号、仓颉字母等，请在输入编码后按 `Shift`+回车键 或 `Control`+回车键。

### 使用编辑键

使用 ←→键 定位光标插入点「‸」（或显示为「›」），编辑输入码。
也可用来缩短后选词所对应输入码的范围、确认词句的一部分。

`Home`、`End` 键 快速跳至句首、句末。

`BackSpace`、`Delete` 键 分别删除光标前、后的编码字符。注意在苹果键盘上前者标注为 `Delete`，后者通常是组合键 `Fn+Delete`。

`Escape` 键 清空未完成的输入。

### 删除误上屏的错词

不慎上屏了错误的词组，再打同样的编码时，那错词出现在候选栏，令有洁癖的同学十分不爽。这时候可以：

先把选字光标（用上、下键）移到要删除的用户词组上，再按下 `Shift+Delete` 或 `Control+Delete`（苹果键盘用 `Shift+Fn+Delete`）。

只能够从用户词典中删除词组。用于码表中原有的词组时，只会取消其调频效果。

### Emacs 风格的编辑键

注：Windows 版本 Alt 组合键不可用。

  * ↑：`Control+p`
  * ↓：`Control+n`
  * ←：`Control+b`
  * →：`Control+f`
  * 上页：`Alt+v`
  * 下页：`Control+v`
  * 句首：`Control+a`
  * 句末：`Control+e`
  * 回退：`Control+h`
  * 删除：`Control+d`
  * 清空：`Control+g`
  * 删词：`Control+k`

### 输入标点符号

按键到标点符号的映射有三种形式：
  * 按键对应惟一的符号，按键后直接输出该符号，如「，」
  * 按键对应一组配对的符号，符号交替出现，如「“”」
  * 按键对应多种符号，按键后展现选单。此时可按空格键或回车键确认高亮的符号，反复按该键则选中下一种符号。

每一款输入方案，都可以定义两套符号表，用「方案选单」里的「半角↔全角」选项往复切换。

科技文体惯用西文标点，可进入「方案选单」、选择「，。→，．」切换至西文标点。
西文标点也支持半角、全角两种形式。但不支持自定义，所有标点直接输出。

### 中西文切换

打开「方案选单」，使用选项「中文↔西文」可在两种转换状态间往复切换。

此外，默认可用左右 `Shift` 键快速切换。

在输入了部分编码的情况下，左 `Shift` 将这些编码临时转还为西文。编辑临时转换的西文并以回车键上屏后，自动回复中文状态。

在输入了部分编码的情况下，右 `Shift` 将上屏当前的候选字，并进入西文模式。

以上可总结为：左 `Shift` 切换输入法光标左面的编码内容，右 `Shift` 切换光标右面即将输入的内容。

注意：Mac 系统上的鼠须管不能区分左、右 `Shift` ，因此左、右 `Shift` 键的作用一样。

### 繁简字切换

Rime 输入法词库多以传统汉字编排。

因为有 OpenCC 提供准确而高效的繁→简转换功能，大多数输入方案都可以从「方案选单」里选择「汉字↔汉字」的选项来启用或停用繁简转换。

码表为简化字的方案如【五笔】、【袖珍简化字拼音】等，不提供这个选项。

## 部分输入方案的用法

### 朙月拼音

与时下流行的拼音输入法相近。默认安装后将使用此方案。
其词典包含 Rime 内置的【八股文】繁体词库。设有繁简转换的开关。

敲 \` 键开始用 `hspnz` 输入五笔画（横竖撇捺折），反查五笔编码。需要安装【五笔画】以启用反查。

以下有若干输入方案衍生自朙月拼音，如【语句流】、各式双拼、【宫保拼音】。还有不少方案使用朙月拼音作反查码。

[[《定制指南》|CustomizationGuide]]提供了[[模糊音|CustomizationGuide#模糊音]]定制方法及代码模板。

### 语句流

揉合了语句输入的按键习惯，以及词组输入逐词确认的操作节奏。

句中空格键的运用，既起到明确词边界、弥补长句转换精度不足的作用，又很好地模仿了西文以空格断词的惯用法。

配合 Mac、IBus 版本内嵌预编辑文字的特性，体验更佳。

### 双拼

基于【朙月拼音】制作了几种流行的双拼方案：自然码、MSPY、智能ABC、小鹤双拼、拼音加加等。

双拼与【朙月拼音】、语句流输入方案共用一份码表和用户词典。

实现双拼的关键，是用 Rime 的[[「拼写运算」|SpellingAlgebra]]技术建立双拼输入码到全拼的映射表，从而对接朙月拼音词典。在[[《输入方案设计书》|RimeWithSchemata]]中有一个完整的代码示例。

### 宫保拼音

仍是基于【朙月拼音】，采用源自西方速录技术的多键并击方式，双手共七指操作键盘，一击输入一个拼音音节。

宫保拼音 / Combo Pinyin 自从2007年创制以来，经历十数次修订，孜孜以求一套直观易用，并且兼顾PC键盘上操作舒适度的键位布局。

[[宫保拼音专题介绍|ComboPinyin]]

### 地球拼音

支持标注声调的拼音输入法。

以形似的符号  `- / < \` 附加在拼音音节的末尾，分别表示阴平、阳平、上声、去声。轻声不标。

为按键方便故，也可使用 `; / , >` 来标注。

声调、韵母在输入常用短语时可以省略，而成为简拼。因此本方案既兼容了无声调拼音输入法的打字习惯，又可在输入生僻字词时通过输入声调筛选出同音同调者。

因为对应相同的音系，【地球拼音】与【注音】共享词典，却不与【朙月拼音】相通。

### 注音

注音符号输入法。使用最广泛的「大千式」键盘排布。

但其操作层面不同于传统的注音输入法，而是采取「无模式」的设计，与 Rime 里的其他输入方案达成统一。
所谓「无模式」，是指输入注音码，会即时显示出候选字，而不似传统的注音输入法需要另行呼出选字窗口。

Rime【注音】输入方案，允许省略声调（包含作为第一声的空格键）以及某些音节（非零声母且声母不能自成音节者）的韵母部分。
当省略声调时，可连续输入后一个音节，或间以隔音符号「 ' 」表明前一音节结束。

此外，【注音】采用了语句流的按键习惯，以回车键确认上屏；在输入了声调的音节后，以空格键选定高亮的字词。

为了在输入注音码的同时展现候选字，候选的序号改为大写字母ABCDE等，以避开定义为注音符号的数字键。
要选用当页第二个候选字，可按↓键、再按空格键选定第二字，又可按下 `Shift+B` 键直接选取。

一些标点符号由于所在按键用作输入注音符号的原因而有所调整：
  * 逗号， `Shift+,`
  * 句号。 `Shift+.`
  * 分号； `Shift+;`
  * ／号  `Shift+/`
  * 减号  `Shift+-`
规则很简单：符号键被注音字母占用时，加打上档键 Shift 从符号列表中选取。

### 仓颉

第五代仓颉输入法。

默认，通过仓颉码检出的候选字限制在「通用字符集」，排除了 Unicode CJKV 扩展区汉字。

需要输入大量古字、生僻字的专业用户，请在「方案选单」中切换一次形如「通用 → 增广」的字符集过滤开关，即可输入七万余简繁汉字。

注：您的系统可能需要安装专门的字体方可正确显示汉字全集。参考[[《定制指南》|CustomizationGuide]]为 Rime 输入法设定用于显示候选文字的字体。

以拼音输入单字、常用词组，可反查仓颉码。需要安装【朙月拼音】以启用反查。仓颉码与拼音重码时，仓颉码查到的候选字优先。
亦可按引导键 ` 进入拼音反查。

看到候选字一旁有「阴阳鱼 ☯」记号？

`:-D` 这表示，该候选词组并不存在于码表中，而是通过「混元编码器」产生、或由已知字码自动组合而成的结果。您需要确认一下这是否恰是你想要的词。
Rime 的后续版本将不断改进算法，在输入码未命中码表时，推测出更有意义的文字，越来越「懂我心意」。

### 速成

取仓颉首尾二码，简单快速地连续输入词、句，且支持仓颉全码、速成码混合输入。编码虽是基于字形，智能组词、调频等特性与拼音输入法别无二致。

### 五笔

五笔字型86版。简化字优先，兼收繁体字。包含小规模的词库。

敲 z 键开始转为简体拼音字词输入，反查五笔编码。需要安装【袖珍简化字拼音】以启用反查。

另有【五笔·拼音】混合输入的方案。在这款方案里，可直接以五笔或拼音码输入字、词而无须转换。输入拼音码时，若候选字、词编入了五笔码表，则在候选字一旁提示其五笔码。

### 粤拼

以[「香港语言学学会粤语拼音方案（粤拼）」](http://www.lshk.org/)输入广府话。

敲引导键 ` 之后，开始输入汉语拼音（普通话）反查粤拼。需要安装【朙月拼音】以启用反查。

输入不完整的粤拼编码、或当拼写错误被自动纠正时，候选字、词加注完整的粤拼编码提示。
（注意：由于码表并未全部经过人工校对，程序自动注音的结果可能使提示中多音字的标注出现错误！请不要把输入法的提示当作标准学习而受误导！）

### 吴语

以[「吴语拉丁式注音法」](http://input.foruto.com/wu/method.html)输入上海话、苏州话。

敲引导键 ` 之后，开始输入汉语拼音（普通话）反查吴语拼写。需要安装【朙月拼音】以启用反查。

《定制指南》提供了模糊音定制方法及模板。

## 用户词典管理

从【小狼毫】开始菜单或托盘图标的右键菜单中打开「用户词典管理」介面。

左侧列表为已使用的用户词典，以词典名表示，如 `luna_pinyin` 。
注意词典与输入方案可能是一对多的关系。

### 命令行工具

【中州韵】和【鼠须管】暂无图形工具，可取得 librime 编译产出的工具程序 `bin/rime_dict_manager` 通过命令行方式实现以下功能。

执行 `rime_dict_manager` 之前需要关闭正在使用的输入法，释放以独占方式打开的词典文件。

请，将工作目录设为「Rime 用户资料夹」。在此执行 `rime_dict_manager` 查看所支持的参数及命令格式；加上参数 `--list` 查看用户词典列表。

### 备份及合并词典快照

Rime 输入法在使用中会在一定时间自动将用户词典备份为快照文件 `*.userdb.txt` 。
也可使用管理工具，备份指定的用户词典到快照文件。

备份到快照中的打字习惯，可回复到新建立的或其他系统上的用户词典。

执行合并词典快照操作，只须选定要合并的 `.userdb.txt` 文件，因为快照中已记录了所属词典的名称。

你不必担心来自快照的词条已存在于用户词典的情况；词频更新为二者的较大值，其他参数亦会按照合理的算法叠加。

### 导出及导入文本码表

将用户词典导出为文本码表，便于直接阅读，或批量添加词条到 `*.dict.yaml` 。

导出的文本格式与 Rime 静态码表的格式相同：以制表符（Tab）分隔的三列，分别是文字、编码、使用频次。其中，编码是码表中定义的完全形式，多个音节间以空格。

如此导出的文本码表，可反向导入到指定的用户词典。但是，文本码表所含信息不如快照全面，因此为了不损失输入效果，请尽量使用 *合入快照* 的方式转移用户资料。

由于文本码表用户可以编辑，导入时无法检查码表内容是否与选定的词典相匹配，请 **当心** 莫要导入到错误的词典中去了。

### 导入其他来源的码表

推荐的作法是，将码表导入到固态词典，而非用户词典。

请参考以下两个示例：

https://gist.github.com/lotem/5443073

https://github.com/rime-aca/dictionaries

特别地，如果要用新码表的内容完全取代原有的 `luna_pinyin` 词典，则无须以上步骤：
将编写好的新词典命名为 `luna_pinyin.dict.yaml` 放置于 Rime 的 [用户文件夹](https://github.com/rime/home/wiki/UserData)，重新部署即可。

---

如果你认定要将码表导入已存在的用户词典，则要注意：
  * 码表文件的格式是否 Rime 所要求的 UTF-8 (no BOM) 编码
  * 文本行是否为制表符分隔，至少有文字、编码两列，及一列可选的频次
  * 文字的字形（繁、简字）是否与源码表一致
  * 编码的形式是否源码表中定义的标准形式

第一点，有一台专业的文本编辑器就控制住啦。比如VIM里面用命令

    :set fenc=utf8 nobomb ff=unix

转换、保存文件就中啦。

第二点，如果来源文件的资料格式不同，就需要借助 regex 批量替换的操作，或写脚本来完成转换。

只有词条、没有编码？请重新考虑先时我提出的建议。因为，制作固态词典，可以利用【八股文】，以及自动编码器。

第三点，如果字形与目标词典不一致，推荐用 [OpenCC](https://github.com/BYVoid/OpenCC) 完成码表的繁、简转换。

第四点，凡是编码为源码表中未出现过的形式，如通过「拼写运算」实现的简拼、异拼，又如编码中的拼写错误，都将导致该条记录成为用户词典中的无效数据，因为无法通过正常的输入检索到。

### 添加自定义短语

若个别编码的格式与主词典的编码类型（例如拼音）不同，推荐采用自定义短语机制。

自定义短语是一种用文本文件存储的简单 Rime 词典。可定义编码为固定字符串的文字。

预设的「朙月拼音」输入方案已经包含自定义短语的相关设置，文件位置为
[用户文件夹](https://github.com/rime/home/wiki/UserData)/`custom_phrase.txt`，
按下文给出的样例创建文本文件，并重新部署即可。

用家可参考「朙月拼音」在自己的方案中添加两处代码，以启用自定义短语：

 - https://github.com/rime/rime-luna-pinyin/blob/781ba525b1e2819170a85f98b0047f5b7450868f/luna_pinyin.schema.yaml#L49
 - https://github.com/rime/rime-luna-pinyin/blob/781ba525b1e2819170a85f98b0047f5b7450868f/luna_pinyin.schema.yaml#L72

Rime 自定义短语文件样例 <https://gist.github.com/lotem/5440677>

``` yaml
# Rime table
# coding: utf-8
#@/db_name	custom_phrase.txt
#@/db_type	tabledb
#
# 用于【朙月拼音】系列输入方案
# 【小狼毫】0.9.21 以上
#
# 请将该文件以UTF-8编码保存为
# Rime 用户文件夹/custom_phrase.txt
#
# 码表各字段以制表符（Tab）分隔。各字段为：
#   - 文字
#   - 编码
#   - 权重（决定重码的次序、可选，权重高则选项在前）
#
# 虽然文本码表方便编辑，但性能有限，不适合导入大量条目。
#
# 出现在以下这行注释之后的 # 不再识别为注释：
# no comment

中州韵输入法引擎	rime	3
Rime Input Method Engine	rime	2
https://rime.im/	rime	1
星际我争霸	starcraft
tassadar@protoss.net	email
```

### 同步用户资料

借助移动存储设备，或在线存储服务如Dropbox，在多台电脑及不同系统之间同步用户词典和用户设定。

#### 设定同步位置

默认地，词典快照备份到 [RIME用户文件夹](https://github.com/rime/home/wiki/UserData)\sync\UUID 这个地方。如果你要用 Dropbox 或 U盘在不同机器/系统之间同步用户词典，则需要设定同步的目标文件夹，如 `D:\Dropbox\RimeSync` 。

直接编辑用户文件夹下的 `installation.yaml` ，添加：

    sync_dir: 'D:\Dropbox\RimeSync'

又如 Mac 上添加：

    sync_dir: '/Users/fred/Dropbox/RimeSync'

又如使用 USB 存储来同步：（[真实案例](https://gist.github.com/4483504)）

    sync_dir: '/Volumes/USBDRIVE/RimeSync'

默认地，每套 Rime 会随机生成一个 UUID 作为标识。不同 installation ID 可区分来自不同机器/系统的用户词典。

与安装在其他系统上的 Rime 同步后，同步文件夹呈如下布局：

    D:\Dropbox\RimeSync\id-xxx\luna_pinyin.userdb.txt
    D:\Dropbox\RimeSync\id-xxx\terra_pinyin.userdb.txt
    D:\Dropbox\RimeSync\id-xxx\installation.yaml
    D:\Dropbox\RimeSync\id-xxx\default.custom.yaml
    D:\Dropbox\RimeSync\id-xxx\weasel.custom.yaml

    D:\Dropbox\RimeSync\id-yyy\terra_pinyin.userdb.txt
    D:\Dropbox\RimeSync\id-yyy\installation.yaml
    D:\Dropbox\RimeSync\id-yyy\default.custom.yaml
    D:\Dropbox\RimeSync\id-yyy\squirrel.custom.yaml

    D:\Dropbox\RimeSync\id-zzz\luna_pinyin.userdb.txt
    D:\Dropbox\RimeSync\id-zzz\installation.yaml
    D:\Dropbox\RimeSync\id-zzz\alternative.yaml
    D:\Dropbox\RimeSync\id-zzz\luna_pinyin.custom.yaml

同步时，依次将各子文件夹中的词典快照合并到用户词典，最后为合并后的用户词典生成一份新的快照文件。
另外，还会把用户文件夹中非自动生成的 YAML 文件及 .txt 文件单向 **备份** 到同步文件夹。

有些特别讲究命名的用家，不喜随机生成的 UUID，可编辑 `installation.yaml` ，取一个有意义的 ID，如：

    installation_id: 'fred-win7-desktop'

又如：

    installation_id: 'fred-macbook'

当心！因为 Rime 要以这个 ID 为名创建文件夹，因此 ID 不得包含（所有涉及同步的文件系统）文件名中非法的字符；建议不要用中文，只用小写字母、数字、横线和下划线。
